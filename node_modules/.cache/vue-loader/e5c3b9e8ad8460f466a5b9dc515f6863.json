{"remainingRequest":"/Users/xxk/Desktop/mall/node_modules/.15.7.0@vue-loader/lib/index.js??vue-loader-options!/Users/xxk/Desktop/mall/src/views/KhLogin.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xxk/Desktop/mall/src/views/KhLogin.vue","mtime":1558950890000},{"path":"/Users/xxk/Desktop/mall/node_modules/.2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xxk/Desktop/mall/node_modules/.2.1.2@thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xxk/Desktop/mall/node_modules/.8.0.6@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/xxk/Desktop/mall/node_modules/.2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xxk/Desktop/mall/node_modules/.15.7.0@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport User from '../api/user'\r\n\r\nexport default {\r\n    data(){\r\n        return{\r\n            isSmsLogin: true,\r\n            codeMsg: '获取验证码',\r\n            countdown: 60,\r\n            timer: null,\r\n            username: '',\r\n            pwd: '',\r\n            code: '',\r\n            errMsg: '',\r\n        }\r\n    },\r\n    computed: {\r\n        placeholderTxt(){\r\n            return this.isSmsLogin ? '账号或手机号' : '手机号'\r\n        },\r\n        changeLogin(){\r\n            return this.isSmsLogin ? '手机验证码登录' : '用户名密码登录'\r\n        },\r\n    },\r\n    watch:{\r\n        $route(to,from){\r\n            console.log(to.path);\r\n        }\r\n    },\r\n    methods: {\r\n        changeBtn(){\r\n            this.isSmsLogin = !this.isSmsLogin\r\n        },\r\n        getCode(){\r\n            if(!this.username){\r\n                this.errMsg = '请输入手机号'\r\n                return\r\n            }\r\n            if(!this.checkMobile()){\r\n                this.errMsg = '手机号码格式不正确'\r\n                return\r\n            }\r\n            if(this.countdown !== 60) return\r\n            this.timer = setInterval(() => {\r\n                this.codeMsg = `重新发送${this.countdown}`\r\n                this.countdown --\r\n                if(this.countdown === 0){\r\n                    clearInterval(this.timer)\r\n                    this.timer = null\r\n                    this.countdown = 60\r\n                    this.codeMsg = '获取验证码'\r\n                }\r\n            }, 1000)\r\n        },\r\n        submit(){\r\n            // 校验\r\n            if(this.isSmsLogin){\r\n                if(!this.username){\r\n                    this.errMsg = '请输入账号'\r\n                    return\r\n                }\r\n                if(!this.pwd){\r\n                    this.errMsg = '请输入密码'\r\n                    return\r\n                }\r\n            }else{\r\n                if(!this.username){\r\n                    this.errMsg = '请输入手机号'\r\n                    return\r\n                }\r\n                if(!this.checkMobile()){\r\n                    this.errMsg = '手机号码格式不正确'\r\n                    return\r\n                }\r\n                if(!this.code){\r\n                    this.errMsg = '请输入短信验证码'\r\n                    return\r\n                }\r\n            }\r\n            // let data = {\r\n            //     username: this.username\r\n            // }\r\n            // this.$fetch('UserInfo', {\r\n            User.UserLogoin({\r\n                \"SOURCE\": \"TEST\",\r\n                \"CREDENTIALS\": \"0\",\r\n                \"ADDRESS\": \"192.168.1.195\",\r\n                \"TERMINAL\": \"0\",\r\n                \"INDEX\": \"20170714\",\r\n                \"METHOD\": \"UserLogoin\",\r\n                \"UserAccount\": this.username,\r\n                \"UserPasswd\": this.pwd,\r\n                \"LoginIP\": \"192.168.1.195\"\r\n            }).then(res => {\r\n                console.log(res)\r\n                if(res.DATA){\r\n                    let statu = res.DATA[0]\r\n                    if(statu === 0){\r\n                        this.errMsg = '账号或密码错误'\r\n                    }else if(statu === 1){\r\n                        this.$store.commit('changeLoginStatu', res)\r\n                        let path = this.$route.query.redirect || '/user'\r\n                        this.$router.push(path)\r\n                    }else if(statu === 2){\r\n                        this.errMsg = '账号异常'\r\n                    }\r\n                }\r\n            })\r\n        },\r\n        checkMobile(){\r\n            if(this.username == ''){\r\n                this.errMsg == '手机号不能为空'\r\n                return\r\n            }\r\n            const reg = /^((1[3-8][0-9])+\\d{8})$/\r\n            return reg.test(this.username)\r\n        },\r\n        onForgetPwd(){\r\n            this.$router.push('/forgetPwd')\r\n        },\r\n        goBack(){\r\n            this.isSmsLogin = !this.isSmsLogin\r\n        },\r\n        onClose(){\r\n            this.$router.push('./home')\r\n        }\r\n    }\r\n}\r\n",{"version":3,"sources":["KhLogin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"KhLogin.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <div class=\"layout\">\r\n        <header class=\"app-view-header\">\r\n            <div v-show=\"!isSmsLogin\" class=\"back\">\r\n                <img @click=\"goBack\" src=\"../assets/images/search/ic-back-b@3x.png\" alt=\"\">\r\n            </div>\r\n            <div v-show=\"isSmsLogin\" class=\"close\">\r\n                <img @click=\"onClose\" src=\"../assets/images/login/login_closed@3x.png\" alt=\"\">\r\n            </div>\r\n        </header>\r\n        <div class=\"header_tit\">\r\n            <em class=\"khlogo\"><img src=\"../assets/images/login/logo@3x.png\" alt=\"\"></em>\r\n        </div>\r\n        <div>\r\n            <!-- 输入框 -->\r\n            <!-- <label v-show=\"isSmsLogin\" class=\"login_user\">\r\n                <input type=\"text\" class=\"item_account\" autocomplete=\"off\" placeholder=\"账号或手机号\">\r\n            </label> -->\r\n            <label class=\"login_user\">\r\n                <div v-show=\"!isSmsLogin\" class=\"country_list\">\r\n                    <div class=\"countrycode_selector\">\r\n                        <span class=\"country_code\">\r\n                            <tt class=\"countrycode-value\">+86</tt>\r\n                            <i class=\"icon_arrow_down\"></i>\r\n                        </span>\r\n                    </div>\r\n                    <img src=\"../assets/images/commodity/idetails-ic-Jump-g@3x.png\" alt=\"\">\r\n                </div>\r\n                <img class=\"usericon\" v-show=\"isSmsLogin\" src=\"../assets/images/login/login_ic_account@3x.png\" alt=\"\">\r\n                <input type=\"text\" class=\"item_account\" autocomplete=\"off\" :placeholder=\"placeholderTxt\" v-model.trim=\"username\">\r\n            </label>\r\n            <label v-show=\"isSmsLogin\" class=\"pwd_panel\">\r\n                <img class=\"usericon\" src=\"../assets/images/login/login_ic_password@3x.png\" alt=\"\">\r\n                <input type=\"password\" class=\"item_account\" placeholder=\"密码\" autocomplete=\"off\" v-model.trim=\"pwd\">\r\n                <!-- <i class=\"eye pwd_eye\">eye</i> -->\r\n            </label>\r\n            <label v-show=\"!isSmsLogin\" class=\"pwd_panel\">\r\n                <input type=\"number\" class=\"item_account\" placeholder=\"短信验证码\" autocomplete=\"off\" v-model.trim=\"code\">\r\n                <a href=\"javascript:;\" class=\"sms_code\" @click=\"getCode\">{{codeMsg}}</a>\r\n            </label>\r\n            <div class=\"panel\">\r\n                <div class=\"registered\" v-show=\"isSmsLogin\">快速注册</div>\r\n                <div class=\"code-login\" @click=\"changeBtn\">{{changeLogin}}</div>\r\n            </div>\r\n            <!-- 错误信息 -->\r\n            <div v-show=\"errMsg\" class=\"err_tip\">\r\n                <!-- <em class=\"icon_error\">err</em> -->\r\n                <span class=\"error-con\">* {{errMsg}}</span>\r\n            </div>\r\n            <div class=\"btns_bg\">\r\n                <button class=\"btnadpt\" @click=\"submit\">登录</button>\r\n                <!-- <input type=\"button\" class=\"btnadpt\" value=\"登录\"> -->\r\n            </div>\r\n            <div class=\"other_panel\" v-show=\"isSmsLogin\">\r\n                <a class=\"outer-link\" @click=\"onForgetPwd\">忘记密码？</a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport User from '../api/user'\r\n\r\nexport default {\r\n    data(){\r\n        return{\r\n            isSmsLogin: true,\r\n            codeMsg: '获取验证码',\r\n            countdown: 60,\r\n            timer: null,\r\n            username: '',\r\n            pwd: '',\r\n            code: '',\r\n            errMsg: '',\r\n        }\r\n    },\r\n    computed: {\r\n        placeholderTxt(){\r\n            return this.isSmsLogin ? '账号或手机号' : '手机号'\r\n        },\r\n        changeLogin(){\r\n            return this.isSmsLogin ? '手机验证码登录' : '用户名密码登录'\r\n        },\r\n    },\r\n    watch:{\r\n        $route(to,from){\r\n            console.log(to.path);\r\n        }\r\n    },\r\n    methods: {\r\n        changeBtn(){\r\n            this.isSmsLogin = !this.isSmsLogin\r\n        },\r\n        getCode(){\r\n            if(!this.username){\r\n                this.errMsg = '请输入手机号'\r\n                return\r\n            }\r\n            if(!this.checkMobile()){\r\n                this.errMsg = '手机号码格式不正确'\r\n                return\r\n            }\r\n            if(this.countdown !== 60) return\r\n            this.timer = setInterval(() => {\r\n                this.codeMsg = `重新发送${this.countdown}`\r\n                this.countdown --\r\n                if(this.countdown === 0){\r\n                    clearInterval(this.timer)\r\n                    this.timer = null\r\n                    this.countdown = 60\r\n                    this.codeMsg = '获取验证码'\r\n                }\r\n            }, 1000)\r\n        },\r\n        submit(){\r\n            // 校验\r\n            if(this.isSmsLogin){\r\n                if(!this.username){\r\n                    this.errMsg = '请输入账号'\r\n                    return\r\n                }\r\n                if(!this.pwd){\r\n                    this.errMsg = '请输入密码'\r\n                    return\r\n                }\r\n            }else{\r\n                if(!this.username){\r\n                    this.errMsg = '请输入手机号'\r\n                    return\r\n                }\r\n                if(!this.checkMobile()){\r\n                    this.errMsg = '手机号码格式不正确'\r\n                    return\r\n                }\r\n                if(!this.code){\r\n                    this.errMsg = '请输入短信验证码'\r\n                    return\r\n                }\r\n            }\r\n            // let data = {\r\n            //     username: this.username\r\n            // }\r\n            // this.$fetch('UserInfo', {\r\n            User.UserLogoin({\r\n                \"SOURCE\": \"TEST\",\r\n                \"CREDENTIALS\": \"0\",\r\n                \"ADDRESS\": \"192.168.1.195\",\r\n                \"TERMINAL\": \"0\",\r\n                \"INDEX\": \"20170714\",\r\n                \"METHOD\": \"UserLogoin\",\r\n                \"UserAccount\": this.username,\r\n                \"UserPasswd\": this.pwd,\r\n                \"LoginIP\": \"192.168.1.195\"\r\n            }).then(res => {\r\n                console.log(res)\r\n                if(res.DATA){\r\n                    let statu = res.DATA[0]\r\n                    if(statu === 0){\r\n                        this.errMsg = '账号或密码错误'\r\n                    }else if(statu === 1){\r\n                        this.$store.commit('changeLoginStatu', res)\r\n                        let path = this.$route.query.redirect || '/user'\r\n                        this.$router.push(path)\r\n                    }else if(statu === 2){\r\n                        this.errMsg = '账号异常'\r\n                    }\r\n                }\r\n            })\r\n        },\r\n        checkMobile(){\r\n            if(this.username == ''){\r\n                this.errMsg == '手机号不能为空'\r\n                return\r\n            }\r\n            const reg = /^((1[3-8][0-9])+\\d{8})$/\r\n            return reg.test(this.username)\r\n        },\r\n        onForgetPwd(){\r\n            this.$router.push('/forgetPwd')\r\n        },\r\n        goBack(){\r\n            this.isSmsLogin = !this.isSmsLogin\r\n        },\r\n        onClose(){\r\n            this.$router.push('./home')\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"stylus\">\r\n    .layout{\r\n        padding: 0 28px;\r\n        position: relative;\r\n        box-sizing: border-box;\r\n    }\r\n    .app-view-header{\r\n        img{\r\n            width 20px\r\n            margin-top 18px\r\n        }\r\n        .close{\r\n            text-align right \r\n        }\r\n        .back{\r\n            text-align left \r\n        }\r\n    } \r\n    .usericon{\r\n        width 20px\r\n        margin-right 10px \r\n    }\r\n    .header_tit{\r\n        padding: 30px 0 30px;\r\n        text-align: center;\r\n    }\r\n    .khlogo{\r\n        // width: 48px;\r\n        // height: 48px;\r\n        margin: 0 auto 15px;\r\n        // display: block;\r\n        // background-image: url(../assets/images/milogo.png);\r\n        img{\r\n            width 120px\r\n            // height 100px\r\n        }\r\n    }\r\n    .login_user, .pwd_panel{\r\n        display flex\r\n        align-items center\r\n        position relative\r\n        border-bottom 1px solid #d3d3d3\r\n    }\r\n    .pwd_panel{\r\n        // justify-content: space-between;\r\n    }\r\n    .country_list{\r\n        display flex\r\n        align-items center\r\n        padding: 1px 10px 1px 0;\r\n        margin-right: 8px;\r\n        color: #4a4a4a;\r\n        // display: block;\r\n        overflow: hidden;\r\n        img{\r\n            width 8px\r\n            margin-left 6px\r\n        }\r\n    }\r\n    .countrycode_selector{\r\n        position: relative;\r\n        animation: fade-in ease-in-out .5s;\r\n    }\r\n    @keyframes fade-in{\r\n        0%{\r\n            left: -100%;\r\n        }\r\n        100%{\r\n            left: 0;\r\n        }\r\n    }\r\n    .country_code{\r\n        display: flex;\r\n        align-items: center;\r\n    }\r\n    .countrycode-value{\r\n        margin-right: 2px;\r\n        color: #939393;\r\n        font-size: 16px;\r\n    }\r\n    .panel{\r\n        display: flex;\r\n        justify-content: space-between;\r\n        margin-top: 12px;\r\n        margin-bottom: 10px; \r\n        font-size: 14px;\r\n    }\r\n    .panel .registered{\r\n        padding: 4px 14px 4px 0;\r\n    }\r\n    .panel .code-login{\r\n        padding: 4px 0 4px 0;\r\n    }\r\n    .btns_bg{\r\n        padding-top: 24px;\r\n    }\r\n    .btnadpt{\r\n        width: 100%;\r\n        display: block;\r\n        padding: 12px 0;\r\n        // margin-bottom: 24px;\r\n        border: none;\r\n        border-top-left-radius: 25px;\r\n        border-bottom-right-radius: 25px;\r\n        box-shadow: 0 5px 20px 4px rgba(255, 57, 72, .25);\r\n        background-color: #ff3948;\r\n        text-align: center;\r\n        font-size: 18px;\r\n        color: #fff;\r\n        cursor: pointer;\r\n    }\r\n    .outer-link{\r\n        display inline-block\r\n        padding: 0 9px;\r\n        margin-top: 24px;\r\n        color: #646464;\r\n    }\r\n    .sms_code{\r\n        position absolute\r\n        right 0\r\n        padding: 6px 12px;\r\n        background: #ff3948;\r\n        border-radius: 15px;\r\n        font-size: 14px;\r\n        color: #fff;\r\n    }\r\n    .err_tip{\r\n        margin-bottom: 5px;\r\n        padding-top: 14px;\r\n        color: #F66;\r\n        text-align: left;\r\n        font-size: 14px;\r\n    }\r\n</style>\r\n"]}]}